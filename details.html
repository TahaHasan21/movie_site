<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Search Website</title>
    <!-- font awesome icons cdn -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- custom css -->
    <link rel = "stylesheet" href = "details.css">
</head>
<body>
    
    <header>
        <nav class="navbar">
            <span class="hamburger-btn material-symbols-rounded">menu</span>        
                <h2>My Movies</h2>
            <ul class="links">
                <li><a href="home.html">Home</a></li>
                <li><a href="mylist.html">MyList</a></li>
                <!-- <li><a href="contact.html">Contact us</a></li> -->
            </ul>            
            <button id="logout" class="logout-btn">LOG OUT</button>
        </nav>
    </header>

    <div class="movie-details" id="movieDetails">
        <div class = "container">
            <div class = "result-container">
                <div class = "result-grid" id = "result-grid">
                    <!-- movie information here -->
                    <!-- <div class = "movie-poster">
                        <img src = "medium-cover.jpg" alt = "movie poster">
                    </div>
                    <div class = "movie-info">
                        <h3 class = "movie-title">Guardians of the Galaxy Vol. 2</h3>
                        <ul class = "movie-misc-info">
                            <li class = "year">Year: 2017</li>
                            <li class = "rated">Ratings: PG-13</li>
                            <li class = "released">Released: 05 May 2017</li>
                        </ul>
                        <p class = "genre"><b>Genre:</b> Action, Adventure, Comedy</p>
                        <p class = "writer"><b>Writer:</b> James Gunn, Don Abnett, Andy Lanning</p>
                        <p class = "actors"><b>Actors: </b>Chris Pratt, Zoe Saldana, Dave Bautista</p>
                        <p class = "plot"><b>Plot:</b> The Guardians struggle to keep together as a team while dealing with their personal family issues, notably Star-Lord's ecounter with his father the ambitious celestial being Ego.</p>
                        <p class = "language"><b>Language:</b> English</p>
                        <p class = "awards"><b><i class = "fas fa-award"></i></b> Nominated for 1 Oscar</p>
                    </div> -->
                </div>
            </div>
        </div>
    </div>


    <!-- movie app js -->
    <script>

const apiKey = 'e87dfff4';

function getMovieDetails() {
    const urlParams = new URLSearchParams(window.location.search);
    const movieId = urlParams.get('id');
    const url = `http://www.omdbapi.com/?i=${movieId}&apikey=${apiKey}`;

    fetch(url)
        .then(response => response.json())
        .then(movie => {
            if (movie.Response === "True") {
                displayMovieDetails(movie);
                document.getElementById('addToPlaylist').addEventListener('click', () => addToPlaylist(movie));
            } else {
                document.getElementById('movieDetails').innerHTML = `<p>Movie details not found</p>`;
            }
        })
        .catch(error => console.error('Error fetching movie details:', error));
}

const resultGrid = document.getElementById('result-grid');

function displayMovieDetails(details) {
    // const movieDetails = document.getElementById('movieDetails');
    resultGrid.innerHTML = `
    <div class = "movie-poster">
        <img src = "${(details.Poster != "N/A") ? details.Poster : "image_not_found.png"}" alt = "movie poster">
    </div>
    <div class = "movie-info">
        <h3 class = "movie-title">${details.Title}</h3>
        <ul class = "movie-misc-info">
            <li class = "year">Year: ${details.Year}</li>
            <li class = "rated">Ratings: ${details.Rated}</li>
            <li class = "released">Released: ${details.Released}</li>
        </ul>
        <p class = "genre"><b>Genre:</b> ${details.Genre}</p>
        <p class = "writer"><b>Writer:</b> ${details.Writer}</p>
        <p class = "actors"><b>Actors: </b>${details.Actors}</p>
        <p class = "plot"><b>Plot:</b> ${details.Plot}</p>
        <p class = "language"><b>Language:</b> ${details.Language}</p>
        <p class = "awards"><b><i class = "fas fa-award"></i></b> ${details.Awards}</p>
        <button id="addToPlaylist" class="custom-btn btn-15">Add to Playlist</button>        
    </div>
    `;
}

function addToPlaylist(movie) {
    const playlistType = prompt('Enter "public" for public playlist or "private" for private playlist');
    if (playlistType === 'public' || playlistType === 'private') {
        const playlists = JSON.parse(localStorage.getItem('playlists')) || [];
        playlists.push({ ...movie, type: playlistType });
        localStorage.setItem('playlists', JSON.stringify(playlists));
        alert('Movie added to playlist');
    } else {
        alert('Invalid playlist type. Please enter "public" or "private".');
    }
}

document.addEventListener('DOMContentLoaded', getMovieDetails);




    </script>
</body>
</html>